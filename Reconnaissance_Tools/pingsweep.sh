#!/bin/bash

# This script was written by the0vercomer.

# This script is an adaptation of the "Scripting with Bash" content taught by
# Heath Adams of TCM Security in the Practical Ethical Hacker (PEH) course.

# The purpose of this script is detect active/responsive hosts on a network
# identified by their IPV4 network address and CIDR notation. Please note that
# a host may not respond to ICMP requests and could still be active in which
# case more advance scanning/probing may be required if you have a known host
# that is blocking ICMP but may allow other TCP/IP protocols such as SSH, HTTP,
# HTTPS, SMB, FTP, etc.

# The start of this script will prompt the user for the network address of their
# scope then prompt for a CIDR notation. This script assumes that the user has a
# basic knowledge of IPv4 subnetting with the use of CIDR notations in lieu of
# subnet masks.

echo "Input the network address of target IP scope."
read -p "IP=" SCOPE_IP
echo "Input target CIDR notation."
read -p "CIDR=/" CIDR
echo " Your target scope is $SCOPE_IP"/"$CIDR."

for IP in `echo $SCOPE_IP | cut -d "." -f1-3` ; do
for LAST in `echo $SCOPE_IP | cut -d "." -f4` ; do

if [[ "$CIDR" == "24" && "$LAST" == "0" ]];
then
 for X in `seq 1 254` ; do
 ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt

elif [[ "$CIDR" == "25" && "$LAST" == "0" ]];
then
 for X in `seq 1 126` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "25" && "$LAST" == "128" ]];
then
 for X in `seq 129 254` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt

elif [[ "$CIDR" == "26" && "$LAST" == "0" ]];
then
 for X in `seq 1 62` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "26" && "$LAST" == "64" ]];
then
 for X in `seq 65 126` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "26" && "$LAST" == "128" ]];
then
 for X in `seq 129 190` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "26" && "$LAST" == "192" ]];
then
 for X in `seq 193 254` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "27" && "$LAST" == "0" ]];
then
 for X in `seq 1 30` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "27" && "$LAST" == "32" ]];
then
 for X in `seq 33 62` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "27" && "$LAST" == "64" ]];
then
 for X in `seq 65 94` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "27" && "$LAST" == "96" ]];
then    
 for X in `seq 97 126` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "27" && "$LAST" == "128" ]];
then
 for X in `seq 129 158` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "27" && "$LAST" == "160" ]];
then
 for X in 'seq 161 190' ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "27" && "$LAST" == "192" ]];
then
 for X in `seq 193 222` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "27" && "$LAST" == "224" ]];
then
 for X in `seq 225 254` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "28" && "$LAST" == "0" ]];
then
 for X in `seq 1 14` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "28" && "$LAST" == "16" ]];
then
 for X in `seq 17 30` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "28" && "$LAST" == "32" ]];
then
 for X in `seq 33 46` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "28" && "$LAST" == "48" ]];
then
 for X in `seq 49 62` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "28" && "$LAST" == "64" ]];
then
 for X in `seq 65 78` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "28" && "$LAST" == "80" ]];
then
 for X in `seq 81 94` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "28" && "$LAST" == "96" ]];
then    
 for X in `seq 97 110` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt

elif [[ "$CIDR" == "28" && "$LAST" == "112" ]];
then
 for X in `seq 113 126` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "28" && "$LAST" == "128" ]];
then
 for X in `seq 129 142` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "28" && "$LAST" == "144" ]];
then
 for X in `seq 145 158` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "28" && "$LAST" == "160" ]];
then
 for X in 'seq 161 174' ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt

elif [[ "$CIDR" == "28" && "$LAST" == "176" ]];
then
 for X in `seq 177 190` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt

elif [[ "$CIDR" == "28" && "$LAST" == "192" ]];
then
 for X in `seq 193 206` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "28" && "$LAST" == "208" ]];
then
 for X in `seq 209 222` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "28" && "$LAST" == "224" ]];
then
 for X in `seq 225 238` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt

elif [[ "$CIDR" == "28" && "$LAST" == "240" ]];
then
 for X in `seq 241 254` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "0" ]];
then
 for X in `seq 1 6` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "8" ]];
then
 for X in `seq 9 14` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "16" ]];
then
 for X in `seq 17 22` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "24" ]];
then
 for X in `seq 25 30` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "32" ]];
then
 for X in `seq 33 38` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "40" ]];
then
 for X in `seq 41 46` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt

elif [[ "$CIDR" == "29" && "$LAST" == "48" ]];
then
 for X in `seq 49 54` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "56" ]];
then
 for X in `seq 57 62` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "64" ]];
then
 for X in `seq 65 70` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "72" ]];
then
 for X in `seq 73 78` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif "$CIDR" == "29" && "$LAST" == "80" ]];
then
 for X in `seq 81 86` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "88" ]];
then
 for X in `seq 89 94` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "96" ]];
then    
 for X in `seq 97 102` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "104" ]];
then
 for X in `seq 105 110` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "112" ]];
then
 for X in `seq 113 118` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "120" ]];
then
 for X in `seq 121 126` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt

elif [[ "$CIDR" == "29" && "$LAST" == "128" ]];
then
 for X in `seq 129 134` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt

elif [[ "$CIDR" == "29" && "$LAST" == "136" ]];
then
 for X in `seq 137 142` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "144" ]]
then
 for X in `seq 145 150` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "152" ]];
then
 for X in `seq 153 158` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "160" ]];
then
 for X in 'seq 161 166' ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "168" ]];
then for X in `seq 167 174` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt

elif [[ "$CIDR" == "29" && "$LAST" == "176" ]];
then
 for X in `seq 177 182` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt

elif [[ "$CIDR" == "29" && "$LAST" == "184" ]];
then
 for X in `seq 185 190` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "192" ]];
then
 for X in `seq 193 198` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt

elif [[ "$CIDR" == "29" && "$LAST" == "200" ]];
then
 for X in `seq 201 206` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "208" ]];
then
 for X in `seq 209 214` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "216" ]];
then
 for X in `seq 217 222` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "224" ]];
then
 for X in `seq 225 230` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "232" ]];
then
 for X in `seq 233 238` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
	
elif [[ "$CIDR" == "29" && "$LAST" == "240" ]];
then
 for X in `seq 241 246` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt

elif [[ "$CIDR" == "29" && "$LAST" == "248" ]];
then
 for X in `seq 249 254` ; do
 ping -c 1 $IP.$X >> /tmp/IP.txt | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" & done
 cat /tmp/IP.txt
    
else
 echo "Please input a valid network address and CIDR notation combination."
fi
