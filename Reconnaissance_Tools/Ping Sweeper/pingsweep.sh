#!/bin/bash

# This script was written by the0vercomer.

# https://github.com/The0vercomer/

# This script is an adaptation of the "Scripting with Bash" content taught by
# Heath Adams of TCM Security in the Practical Ethical Hacker (PEH) course.

# The purpose of this script is detect active/responsive hosts on a network
# identified by their IPV4 network address and CIDR notation. Please note that
# a host may not respond to ICMP requests and could still be active in which
# case more advance scanning/probing may be required if you have a known host
# that is blocking ICMP but may allow other TCP/IP protocols such as SSH, HTTP,
# HTTPS, SMB, FTP, etc.

# The start of this script will prompt the user for the network address of their
# scope then prompt for a CIDR notation. This script assumes that the user has a
# basic knowledge of IPv4 subnetting with the use of CIDR notations in lieu of
# subnet masks.

echo "Input the network address of target IP scope."
read -p "IP=" SCOPE_IP
echo "Input target Subnet Mask or CIDR notation. (IE. '255.255.255.0' or '/24')"
read -p "Subnet=" SUBNET

for IP in `echo $SCOPE_IP | cut -d "." -f1-3` ; do
for LAST in `echo $SCOPE_IP | cut -d "." -f4` ; do

if [[ "$SUBNET" == "/24" || "$SUBNET" == "255.255.255.0" ]]
then
    if [ "$LAST" == "0" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 1 254` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done
    
    else
        echo "Please input a valid network address (IE. '$IP.0')"
    fi

elif [[ "$SUBNET" == "/25" || "$SUBNET" == "255.255.255.128" ]]
then
    if [ "$LAST" == "0" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 1 126` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done
    
    elif [ "$LAST" == "128" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 129 254` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    else
        echo "Please input a valid network address (IE. '$IP.0' or '$IP.128')"
    fi  

elif [[ "$SUBNET" == "/26" || "$SUBNET" == "255.255.255.192" ]]
then
    if [ "$LAST" == "0" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 1 62` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "64" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 65 126` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "128" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 129 190` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "192" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 193 254` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    else
        echo "Please input a valid network address."
    fi

elif [[ "$SUBNET" == "27" || "$SUBNET" == "255.255.255.224" ]]
then
    if [ "$LAST" == "0" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 1 30` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "32" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 33 62` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "64" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 65 94` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "96" ]
    then    
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 97 126` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done
    
    elif [ "$LAST" == "128" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 129 158` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "160" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in 'seq 161 190' ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "192" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 193 222` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "224" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 225 254` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    else
        echo "Please input a valid network address."
    fi

elif [[ "$SUBNET" == "28" || "$SUBNET" == "255.255.255.240" ]]
then
    if [ "$LAST" == "0" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 1 14` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "16" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 17 30` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "32" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 33 46` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "48" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 49 62` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "64" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 65 78` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "80" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 81 94` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "96" ]
    then    
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 97 110` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "112" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 113 126` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "128" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 129 142` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "144" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 145 158` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "160" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in 'seq 161 174' ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "176" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 177 190` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "192" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 193 206` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "208" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 209 222` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "224" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 225 238` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "240" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 241 254` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    else
        echo "Please input a valid network address."
    fi

elif [[ "$SUBNET" == "29" || "$SUBNET" == "255.255.255.248" ]]
then
    if [ "$LAST" == "0" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 1 6` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "8" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 9 14` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "16" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 17 22` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "24" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 25 30` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "32" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 33 38` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "40" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 41 46` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "48" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 49 54` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "56" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 57 62` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "64" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 65 70` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "72" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 73 78` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "80" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 81 86` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "88" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 89 94` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "96" ]
    then    
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 97 102` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "104" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 105 110` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "112" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 113 118` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "120" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 121 126` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "128" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 129 134` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "136" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 137 142` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "144" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 145 150` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "152" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 153 158` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "160" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in 'seq 161 166' ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "168" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 167 174` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "176" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 177 182` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "184" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 185 190` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "192" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 193 198` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "200" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 201 206` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "208" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 209 214` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "216" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 217 222` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "224" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 225 230` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "232" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 233 238` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "240" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 241 246` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    elif [ "$LAST" == "248" ]
    then
        echo  " Your target scope is $SCOPE_IP $SUBNET"
        for X in `seq 249 254` ; do
        ping -c 1 $IP.$X | grep "64 bytes" | cut -d " " -f 4 | tr -d ":" >> /tmp/IP.txt & done

    else
        echo "Please input a valid network address."
    fi

else
    echo "Please input a valid IPv4 Class C subnet mask / CIDR notation."
fi
done

echo "Please wait while your results prepared."
wait

echo "The following IPs are responding to ICMP request, consider performing additional reconnaissance."
[ -f /tmp/IP.txt ] && cat /tmp/IP.txt
done
